<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Калькулятор обмена</title>
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
    }
    .container {
        max-width: 800px;
        background: #ffffff;
        margin: 30px;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 0 25px rgba(0,0,0,0.1);
    }
    h1 {
        text-align: center;
        margin-bottom: 20px;
    }
    .top-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        margin-bottom: 15px;
    }
    select, input {
        padding: 8px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 8px;
        width: 100%;
        box-sizing: border-box;
    }
    .row {
        display: flex;
        gap: 15px;
        margin-bottom: 15px;
    }
    .row .col {
        flex: 1;
    }
    .results {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
        gap: 15px;
    }
    .result-box {
        flex: 1;
        background: #f9f9f9;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
    }
    .footer {
        margin-top: 20px;
        background: #f2f2f2;
        padding: 15px;
        border-radius: 8px;
        font-size: 15px;
        line-height: 1.4;
    }
    .lang-switch img {
        width: 30px;
        cursor: pointer;
        margin-left: 8px;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Калькулятор обмена</h1>

    <div class="top-row">
        <div>
            <label>Направление:</label>
            <select id="direction">
                <option value="rub-to-cny">Рубли → Юани</option>
                <option value="cny-to-rub">Юани → Рубли</option>
            </select>
        </div>
        <div class="lang-switch">
            <img src="https://flagcdn.com/w20/ru.png" alt="Русский" onclick="setLanguage('ru')">
            <img src="https://flagcdn.com/w20/cn.png" alt="中文" onclick="setLanguage('cn')">
        </div>
    </div>

    <div class="row">
        <div class="col">
            <label>Ваш курс</label>
            <input type="text" id="myRate" value="11.3">
        </div>
        <div class="col">
            <label>Курс для клиента</label>
            <input type="text" id="clientRate" value="11.8">
        </div>
    </div>

    <div>
        <label>Сумма обмена</label>
        <input type="text" id="amount" value="200000">
    </div>

    <div class="results">
        <div class="result-box">
            <label>Клиент отдаст</label>
            <input type="text" id="clientGives">
        </div>
        <div class="result-box">
            <label>Клиент получит</label>
            <input type="text" id="clientGets">
        </div>
    </div>

    <div class="results">
        <div class="result-box">
            <strong>Прибыль (₽):</strong> <span id="profitRub">0</span>
        </div>
        <div class="result-box">
            <strong>Прибыль (元):</strong> <span id="profitCny">0</span>
        </div>
    </div>

    <div class="footer" id="footerText">
        Здравствуйте, сегодняшний курс: 11.8.<br>
        Сумма обмена: 0.<br>
        Сумма отправки: 0.<br>
        Реквизиты: +7(981)807-18-99, Юй Ц.
    </div>
</div>

<script>
function parseNumber(val) {
    return parseFloat(val.replace(/\s+/g, '').replace(',', '.')) || 0;
}

function formatNumber(num) {
    return num.toLocaleString('ru-RU', {minimumFractionDigits: 2, maximumFractionDigits: 2});
}

function calculate(fromFieldChanged = false) {
    let myRate = parseNumber(document.getElementById('myRate').value);
    let clientRate = parseNumber(document.getElementById('clientRate').value);
    let amount = parseNumber(document.getElementById('amount').value);
    let direction = document.getElementById('direction').value;

    let clientGivesField = document.getElementById('clientGives');
    let clientGetsField = document.getElementById('clientGets');

    let clientGives, clientGets;

    if (fromFieldChanged === 'clientGives') {
        if (direction === 'rub-to-cny') {
            amount = parseNumber(clientGivesField.value);
        } else {
            amount = parseNumber(clientGivesField.value);
        }
    } else if (fromFieldChanged === 'clientGets') {
        if (direction === 'rub-to-cny') {
            amount = parseNumber(clientGetsField.value) * myRate;
        } else {
            amount = parseNumber(clientGetsField.value) / myRate;
        }
    }

    if (direction === 'rub-to-cny') {
        clientGives = amount;
        clientGets = amount / clientRate;
        let profitRub = clientGives - clientGets * myRate;
        document.getElementById('profitRub').textContent = formatNumber(profitRub);
        document.getElementById('profitCny').textContent = formatNumber(profitRub / myRate);
        document.getElementById('footerText').innerHTML = 
            `Здравствуйте, сегодняшний курс: ${clientRate}.<br>` +
            `Сумма обмена: ${formatNumber(clientGets)} юаней.<br>` +
            `Сумма отправки: ${formatNumber(clientGives)} рублей.<br>` +
            `Реквизиты: +7(981)807-18-99, Юй Ц.`;
    } else {
        clientGives = amount;
        clientGets = amount * clientRate;
        let profitCny = clientGives - clientGets / myRate;
        document.getElementById('profitRub').textContent = formatNumber(profitCny * myRate);
        document.getElementById('profitCny').textContent = formatNumber(profitCny);
        document.getElementById('footerText').innerHTML = 
            `Здравствуйте, сегодняшний курс: ${clientRate}.<br>` +
            `Сумма обмена: ${formatNumber(clientGets)} рублей.<br>` +
            `Сумма отправки: ${formatNumber(clientGives)} юаней.`;
    }

    clientGivesField.value = formatNumber(clientGives);
    clientGetsField.value = formatNumber(clientGets);
}

document.querySelectorAll('#myRate, #clientRate, #amount, #direction').forEach(el => {
    el.addEventListener('input', () => calculate());
});
document.getElementById('clientGives').addEventListener('input', () => calculate('clientGives'));
document.getElementById('clientGets').addEventListener('input', () => calculate('clientGets'));

function setLanguage(lang) {
    alert(lang === 'ru' ? 'Русский язык' : '中文');
}

calculate();
</script>
</body>
</html>
