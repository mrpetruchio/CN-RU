<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Калькулятор обмена</title>
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
    }
    .container {
        background: #ffffff;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 30px rgba(0,0,0,0.1);
        max-width: 600px;
        width: 100%;
    }
    h1 {
        text-align: center;
        font-weight: 600;
        margin-bottom: 20px;
        color: #2c3e50;
    }
    .row {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        margin-bottom: 15px;
    }
    .row input, .row select {
        flex: 1;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 8px;
        text-align: center;
    }
    .row label {
        flex: 1;
        text-align: center;
        font-weight: 500;
        padding: 10px 0;
        color: #34495e;
    }
    .results {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        margin-top: 20px;
    }
    .result-box {
        flex: 1;
        background: #f9f9f9;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        border: 1px solid #ddd;
    }
    .result-box input {
        width: 100%;
        text-align: center;
        font-size: 18px;
        border: none;
        background: transparent;
        outline: none;
    }
    .message {
        margin-top: 20px;
        background: #ecf0f1;
        padding: 15px;
        border-radius: 8px;
        font-size: 16px;
        line-height: 1.5;
        color: #2c3e50;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Калькулятор обмена</h1>
    <div class="row">
        <select id="direction">
            <option value="rub_to_cny">₽ → 元</option>
            <option value="cny_to_rub">元 → ₽</option>
        </select>
        <input type="number" id="myRate" placeholder="Ваш курс">
        <input type="number" id="clientRate" placeholder="Клиентский курс">
    </div>
    <div class="row">
        <input type="text" id="amount" placeholder="Введите сумму">
    </div>
    <div class="results">
        <div class="result-box">
            <label>Клиент отдаст</label>
            <input type="text" id="clientGives">
        </div>
        <div class="result-box">
            <label>Клиент получит</label>
            <input type="text" id="clientGets">
        </div>
    </div>
    <div class="result-box" style="margin-top:15px;">
        <label>Ваша прибыль</label>
        <input type="text" id="profit" readonly>
    </div>
    <div class="message" id="message"></div>
</div>

<script>
function parseNumber(val) {
    if (!val) return 0;
    return parseFloat(val.toString().replace(',', '.').replace(/\s+/g, '')) || 0;
}

function updateCalculator(changedField = null) {
    let direction = document.getElementById('direction').value;
    let myRate = parseNumber(document.getElementById('myRate').value);
    let clientRate = parseNumber(document.getElementById('clientRate').value);
    let amount = parseNumber(document.getElementById('amount').value);
    let clientGives = parseNumber(document.getElementById('clientGives').value);
    let clientGets = parseNumber(document.getElementById('clientGets').value);

    if (myRate > 0 && myRate < 1) myRate = 1 / myRate;
    if (clientRate > 0 && clientRate < 1) clientRate = 1 / clientRate;

    if (changedField === 'clientGets') {
        if (direction === 'rub_to_cny') {
            clientGets = parseNumber(document.getElementById('clientGets').value);
            clientGives = clientGets * clientRate;
            amount = clientGives;
        } else {
            clientGets = parseNumber(document.getElementById('clientGets').value);
            clientGives = clientGets * myRate;
            amount = clientGets;
        }
    } else if (changedField === 'clientGives') {
        if (direction === 'rub_to_cny') {
            clientGives = parseNumber(document.getElementById('clientGives').value);
            clientGets = clientGives / clientRate;
            amount = clientGives;
        } else {
            clientGives = parseNumber(document.getElementById('clientGives').value);
            clientGets = clientGives / myRate;
            amount = clientGets;
        }
    } else {
        if (direction === 'rub_to_cny') {
            clientGives = amount;
            clientGets = clientGives / clientRate;
        } else {
            clientGives = amount;
            clientGets = clientGives / myRate;
        }
    }

    let profit = 0;
    if (direction === 'rub_to_cny') {
        profit = (clientGets * clientRate) - (clientGets * myRate);
    } else {
        profit = (clientGets * myRate) - (clientGets * clientRate);
    }

    document.getElementById('amount').value = amount ? amount.toLocaleString('ru-RU') : '';
    document.getElementById('clientGives').value = clientGives ? clientGives.toLocaleString('ru-RU') : '';
    document.getElementById('clientGets').value = clientGets ? clientGets.toLocaleString('ru-RU') : '';
    document.getElementById('profit').value = profit.toFixed(2).toLocaleString('ru-RU');

    let msg = "";
    if (direction === 'rub_to_cny') {
        msg = `Здравствуйте, сегодняшний курс: ${clientRate}. Вы обмениваете ${clientGets.toLocaleString('ru-RU')} юаней, вам нужно отдать ${clientGives.toLocaleString('ru-RU')} рублей, пожалуйста, скиньте по реквизитам +79818071899, Юй Ц.`;
    } else {
        msg = `Здравствуйте, сегодняшний курс: ${clientRate}. Вы обмениваете ${clientGets.toLocaleString('ru-RU')} рублей, вам нужно отдать ${clientGives.toLocaleString('ru-RU')} рублей.`;
    }
    document.getElementById('message').textContent = msg;
}

['myRate', 'clientRate', 'amount', 'direction'].forEach(id => {
    document.getElementById(id).addEventListener('input', () => updateCalculator());
});
document.getElementById('clientGets').addEventListener('input', () => updateCalculator('clientGets'));
document.getElementById('clientGives').addEventListener('input', () => updateCalculator('clientGives'));
</script>
</body>
</html>
